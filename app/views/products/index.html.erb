<!DOCTYPE html>
<html>
  <body>
    <% @products.each do |product| %>
      <h1><%= product.name %></h1>
      <p id="product-<%= product.id %>"><%= truncate product.description %></p>
      <button type="button" class="button" data-id= '<%= product.id %>' onclick="showContent()">More Info</button>
    <% end %>
  </body>
</html>

<script type="text/javascript">
  function showContent() {
    $(function () {
      $('.button').on('click', function () {
        const id = $(this).data('id')
        $.get('/products/' + id + '/description', function (resp) {
          $.get("/products/" + id + "/inventory", function(inventory) {
          var inventoryText = "<strong>Available</strong>";
          if(inventory === "false"){
            inventoryText = "<strong>Sold Out</strong>";
          }
          var descriptionText = "<p>" + description + "</p><p>" + inventoryText + "</p>";
          $("#product-" + id).html(descriptionText);
          })
        })
      })
    })
  }
</script>
