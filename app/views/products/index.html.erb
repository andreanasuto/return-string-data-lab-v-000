<!DOCTYPE html>
<html>
  <body>
    <% @products.each do |product| %>
      <h1><%= product.name %></h1>
      <p id="description-<%= product.id %>"><%= truncate product.description %></p>
      <button type="button" class="button" data-id= '<%= product.id %>' onclick="showContent()">More Info</button>
    <% end %>
  </body>
</html>

<script type="text/javascript">
  function showContent() {
    $(function () {
      $('.button').on('click', function () {
        const id = $(this).data('id')
        $.get('/products/' + id + '/description', function (resp) {
          $('#description-' + id).text(resp)
          $.get('/products/' + id + '/inventory', function (data) {
            if (data == true) {
              $('#description-' + id).append('<p>Available</p>')
            } else {
              $('#description-' + id).append('<p>Sold Out</p>')
            }
          })
        })
      })
    })
  }
</script>
